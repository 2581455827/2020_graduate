C51 COMPILER V9.00   CHENGXU                                                               05/12/2016 04:13:31 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE CHENGXU
OBJECT MODULE PLACED IN chengxu.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE chengxu.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /********************************************************************
   2                                     博易电子科技
   3          *********************************************************************/
   4          #include <reg52.h>             //头文件
   5          #define uchar unsigned char        //宏定义无符号字符型
   6          #define uint  unsigned  int        //宏定义无符号整型
   7          code uchar seg7code[10]={ 0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90}; //显示段码 数码管字跟
   8          uchar wei[4]={0XEf,0XDf,0XBf,0X7f};  //位的控制端                                                                //位控制码
   9          sbit ST=P3^0;   //A/D启动转换信号
  10          sbit OE=P3^1;   //数据输出允许信号
  11          sbit EOC=P3^2;  //A/D转换结束信号
  12          sbit CLK=P3^3;  //时钟脉冲  
  13          uint z,x,c,v,AD0809, date;      //定义数据类型
  14          /******************************************************************
  15          延时函数
  16          ******************************************************************/
  17          void delay(uchar t)
  18          {
  19   1        uchar i,j;
  20   1         for(i=0;i<t;i++)
  21   1         {
  22   2               for(j=13;j>0;j--);
  23   2               { ;
  24   3               }
  25   2         }
  26   1      }
  27          /**********************************************************************
  28                          数码管动态扫描
  29          *********************************************************************/
  30          void xianshi() //显示函数
  31           { 
  32   1      uint z,x,c,v;
  33   1        z=date/1000;                   //求千位
  34   1        x=date%1000/100;               //求百位
  35   1        c=date%100/10;                 //求十位
  36   1        v=date%10;                     //求个位
  37   1      
  38   1            P2=0XFF;
  39   1                P0=seg7code[z]&0x7f;
  40   1                P2=wei[0];
  41   1                delay(80);
  42   1                P2=0XFF;  
  43   1            P0=seg7code[x];
  44   1                P2=wei[1];
  45   1                delay(80);
  46   1                P2=0XFF;  
  47   1                P0=seg7code[c];
  48   1                P2=wei[2];
  49   1                delay(80);
  50   1                P2=0XFF;  
  51   1            P0=seg7code[v];
  52   1                P2=wei[3];
  53   1                delay(80); 
  54   1                P2=0XFF;
  55   1        }
C51 COMPILER V9.00   CHENGXU                                                               05/12/2016 04:13:31 PAGE 2   

  56           /*************************************************************************
  57                                          CLK振荡信号     
  58          **************************************************************************/
  59          void timer0( ) interrupt 1 //定时器0工作方式1
  60          {
  61   1      
  62   1      TH0=(65536-2)/256;        //重装计数初值
  63   1      TL0=(65536-2)%256;        //重装计数初值
  64   1      CLK=!CLK;                         //取反
  65   1      }
  66          
  67           /*************************************************************************
  68                                          主函数  
  69          **************************************************************************/
  70           void main()
  71          { 
  72   1      TMOD=0X01;                        //定时器中断0
  73   1      
  74   1      CLK=0;                            //脉冲信号初始值为0
  75   1      TH0=(65536-2)/256;        //定时时间高八位初值
  76   1      TL0=(65536-2)%256;        //定时时间低八位初值
  77   1      EA=1;                             //开CPU中断
  78   1      ET0=1;                            //开T/C0中断
  79   1      TR0=1;
  80   1       while(1)                          //无限循环
  81   1              {
  82   2              ST=0;                           //使采集信号为低
  83   2              ST=1;                           //开始数据转换
  84   2              ST=0;                           //停止数据转换
  85   2              while(!EOC);            //等待数据转换完毕
  86   2              OE=1;                           //允许数据输出信号
  87   2              AD0809=P1;                  //读取数据
  88   2              OE=0;                           //关闭数据输出允许信号
  89   2              if(AD0809>=251)         //电压显示不能超过5V
  90   2              AD0809=250;
  91   2              date=AD0809*20;         //数码管显示的数据值，其中20为采集数据的毫安值
  92   2              xianshi();                      //数码管显示函数
  93   2          
  94   2          }
  95   1      }       


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    257    ----
   CONSTANT SIZE    =     10    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     16       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
